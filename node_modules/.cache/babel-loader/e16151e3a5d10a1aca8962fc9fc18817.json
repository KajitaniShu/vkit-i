{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hiira_p\\\\Desktop\\\\program\\\\\\u5149\\u5B66\\u6559\\u80B2\\u30B3\\u30F3\\u30C6\\u30F3\\u30C4\\\\kougaku-editor\\\\kougaku-editor\\\\src\\\\components\\\\Draw2D.js\";\nimport React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Draw2D = _ref => {\n  let {\n    itemList,\n    setItemList\n  } = _ref;\n\n  // 要素の追加\n  function drawElement(id, path, x, y, z) {\n    // 要素の画像を追加\n    var ele = $('<img src={path} id={' + id + '} className=\"img move\" />').appendTo('.drop_area'); // 要素の追加\n\n    $('#' + {\n      id\n    }).offset({\n      top: 30,\n      left: 30\n    });\n  } // 関係のない箇所がクリックされたとき，要素の選択状態を解除\n\n\n  $(document).on('click', function (e) {// if(!$(e.target).is('.move') && !$(e.target).is('#rotateSelectedElement')) {\n    //     // .move要素が押されたときとrotateボタンが押されたとき以外の場合\n    //     $(\".move\").removeClass(\"selected\"); // 全ての.move要素から.selectedを外す\n    //     selected_elements = [];             // 選択中の要素を格納する配列を初期化\n    // }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"Draw2D\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"drop_area\",\n      children: itemList.map(value => {\n        return drawElement(value.id, \"images/test.png\", value.x, value.y, value.z);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      id: \"appendBlue\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"b\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u9752\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      id: \"appendRed\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"r\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u8D64\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      id: \"appendImage\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"images/test.png\",\n        className: \"img\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u753B\\u50CF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      id: \"deleteSelectedElement\",\n      children: \"\\u524A\\u9664\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      id: \"rotateSelectedElement\",\n      children: \"\\u56DE\\u8EE2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 21,\n    columnNumber: 9\n  }, this);\n};\n/* field */\n\n_c = Draw2D;\nvar selected_elements = []; // 選択中の要素を格納する配列\n\n/* methods */\n// ボタンの有効化\n\nfunction enableButton() {\n  // 追加する要素を格納する変数\n  var ele; // ボタンクリック時の動作：青\n\n  $(\"#appendBlue\").click(function () {\n    console.log(\"青\", ele);\n    ele = $('<div class=\"b move\"></div>').appendTo('.drop_area'); // 要素の追加\n\n    update(ele); // 状態の更新\n  }); // ボタンクリック時の動作：赤\n\n  $(\"#appendRed\").click(function () {\n    console.log(\"赤\", ele);\n    ele = $('<div class=\"r move\"></div>').appendTo('.drop_area'); // 要素の追加\n\n    update(ele); // 状態の更新\n  }); // ボタンクリック時の動作：画像\n\n  $(\"#appendImage\").click(function () {\n    console.log(\"画像\", ele);\n    ele = $('<img src=\"img/test.png\" class=\"img move\">').appendTo('.drop_area'); // 要素の追加\n\n    update(ele); // 状態の更新\n  }); // 選択要素の削除ボタン\n\n  $(\"#deleteSelectedElement\").click(function () {\n    $('.selected').remove();\n    selected_elements = [];\n  }); // 選択要素の回転ボタン\n\n  $(\"#rotateSelectedElement\").click(function () {\n    // 選択中の全ての要素に対して45度の回転を適用\n    selected_elements.forEach(function (target_element) {\n      var mat = target_element.css(\"transform\"); // matrixを取得\n\n      var vec = matrix2vec(mat); // matrixを行列に変換\n\n      vec = rotate2D(vec, 45); // 行列を45度回転\n\n      mat = vec2matrix(vec); // 行列をmatrixに戻す\n\n      target_element.css('transform', mat); // 回転\n    });\n  });\n} // 更新があったときに呼び出される\n\n\nfunction update(ele) {\n  // 適当なidを割り振る\n  uuid = generateUuid();\n  ele.attr('id', uuid); // .move要素を移動可能にする\n\n  ele.draggable({\n    containment: \".drop_area\" //ドラッグの範囲を制限\n\n  }); // 選択可能にする\n\n  ele.click(function () {\n    if (ele.hasClass('selected')) {\n      ele.removeClass('selected'); // 要素からselectedクラスを削除\n\n      selected_elements = selected_elements.filter(n => n !== ele); // selected_elements配列から，eleのみを削除する\n    } else {\n      ele.addClass('selected'); // 要素にselectedクラスを追加\n\n      selected_elements.push(ele); // 配列に追加\n    }\n  });\n}\n/* UUID生成 */\n// Cf. https://qiita.com/psn/items/d7ac5bdb5b5633bae165\n\n\nfunction generateUuid() {\n  // https://github.com/GoogleChrome/chrome-platform-analytics/blob/master/src/internal/identifier.js\n  // const FORMAT: string = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\";\n  let chars = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".split(\"\");\n\n  for (let i = 0, len = chars.length; i < len; i++) {\n    switch (chars[i]) {\n      case \"x\":\n        chars[i] = Math.floor(Math.random() * 16).toString(16);\n        break;\n\n      case \"y\":\n        chars[i] = (Math.floor(Math.random() * 4) + 8).toString(16);\n        break;\n    }\n  }\n\n  return chars.join(\"\");\n}\n/*二次元回転*/\n// 度数をradに変換\n// https://lab.syncer.jp/Web/JavaScript/Snippet/51/\n\n\nfunction deg2rad(degree) {\n  return degree * (Math.PI / 180);\n} // CSS matrixを配列に変換する\n// https://qiita.com/shogito/items/a5be366464d8cca5bafb\n\n\nfunction matrix2vec(matrix) {\n  var re = /matrix\\((.*)\\)/;\n  var vals = matrix.match(re)[1].replace(/ /g, \"\").split(\",\");\n  vec = vals.map(Number);\n  return vec;\n}\n\nfunction vec2matrix(vec) {\n  var vals = []; // 有効桁数を揃える\n\n  vals[0] = vec[0].toFixed(20);\n  vals[1] = vec[1].toFixed(20);\n  vals[2] = vec[2].toFixed(20);\n  vals[3] = vec[3].toFixed(20);\n  vals[4] = vec[4].toFixed(20);\n  vals[5] = vec[5].toFixed(20); // 文字列化\n\n  var matrix = \"matrix(\" + vals[0] + \",\" + vals[1] + \",\" + vals[2] + \",\" + vals[3] + \",\" + vals[4] + \",\" + vals[5] + \")\";\n  return matrix;\n} // CSS matrixの二次元回転\n// https://w3e.kanazawa-it.ac.jp/math/category/gyouretu/senkeidaisu/henkan-tex.cgi?target=/math/category/gyouretu/senkeidaisu/rotation_matrix_2d.html\n// https://ginpen.com/2018/11/13/understanding-transform-matrix/\n\n\nfunction rotate2D(vec, degree) {\n  var ret = new Array(6); // xベクトルに二次元回転行列をかける\n\n  ret[0] = vec[0] * Math.cos(deg2rad(degree)) - vec[1] * Math.sin(deg2rad(degree));\n  ret[1] = vec[0] * Math.sin(deg2rad(degree)) + vec[1] * Math.cos(deg2rad(degree)); // yベクトルに二次元回転行列をかける\n\n  ret[2] = vec[2] * Math.cos(deg2rad(degree)) - vec[3] * Math.sin(deg2rad(degree));\n  ret[3] = vec[2] * Math.sin(deg2rad(degree)) + vec[3] * Math.cos(deg2rad(degree)); // 起点の指定\n\n  ret[4] = vec[4];\n  ret[5] = vec[5];\n  return ret;\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"Draw2D\");","map":{"version":3,"sources":["C:/Users/hiira_p/Desktop/program/光学教育コンテンツ/kougaku-editor/kougaku-editor/src/components/Draw2D.js"],"names":["React","Draw2D","itemList","setItemList","drawElement","id","path","x","y","z","ele","$","appendTo","offset","top","left","document","on","e","map","value","selected_elements","enableButton","click","console","log","update","remove","forEach","target_element","mat","css","vec","matrix2vec","rotate2D","vec2matrix","uuid","generateUuid","attr","draggable","containment","hasClass","removeClass","filter","n","addClass","push","chars","split","i","len","length","Math","floor","random","toString","join","deg2rad","degree","PI","matrix","re","vals","match","replace","Number","toFixed","ret","Array","cos","sin"],"mappings":"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","sourcesContent":["import React from 'react';\n\nexport const Draw2D = ({itemList, setItemList}) => {\n    // 要素の追加\n    function drawElement(id, path, x, y, z){\n          // 要素の画像を追加\n        var ele = $('<img src={path} id={'+id+'} className=\"img move\" />').appendTo('.drop_area');   // 要素の追加\n        $('#'+{id}).offset({ top: 30, left: 30 });\n    }\n\n\n    // 関係のない箇所がクリックされたとき，要素の選択状態を解除\n    $(document).on('click', function(e) {\n        // if(!$(e.target).is('.move') && !$(e.target).is('#rotateSelectedElement')) {\n        //     // .move要素が押されたときとrotateボタンが押されたとき以外の場合\n        //     $(\".move\").removeClass(\"selected\"); // 全ての.move要素から.selectedを外す\n        //     selected_elements = [];             // 選択中の要素を格納する配列を初期化\n        // }\n    });\n    return (\n        <div className=\"Draw2D\">\n            <div className=\"drop_area\">\n                {itemList.map((value) => {\n                        return (\n                            drawElement(value.id, \"images/test.png\", value.x, value.y, value.z)\n                        )\n                })}\n            </div>\n            <button type=\"button\" id=\"appendBlue\">\n                <div className=\"b\"></div>\n                <p>青</p>\n            </button>\n            <button type=\"button\" id=\"appendRed\">\n                <div className=\"r\"></div>\n                <p>赤</p>\n            </button>\n            <button type=\"button\" id=\"appendImage\">\n                <img src=\"images/test.png\" className=\"img\" />\n                <p>画像</p>\n            </button>\n            <button type=\"button\" id=\"deleteSelectedElement\">削除</button>\n            <button type=\"button\" id=\"rotateSelectedElement\">回転</button>\n        </div>\n    );\n}\n\n\n/* field */\nvar selected_elements = [];  // 選択中の要素を格納する配列\n\n/* methods */\n\n// ボタンの有効化\nfunction enableButton() {\n    // 追加する要素を格納する変数\n    var ele;\n    // ボタンクリック時の動作：青\n    $(\"#appendBlue\").click(function () {\n        console.log(\"青\", ele);\n        ele = $('<div class=\"b move\"></div>').appendTo('.drop_area');   // 要素の追加\n        update(ele);    // 状態の更新\n    });\n\n    // ボタンクリック時の動作：赤\n    $(\"#appendRed\").click(function () {\n        console.log(\"赤\", ele);\n        ele = $('<div class=\"r move\"></div>').appendTo('.drop_area');   // 要素の追加\n        update(ele);    // 状態の更新\n    });\n\n    // ボタンクリック時の動作：画像\n    $(\"#appendImage\").click(function () {\n        console.log(\"画像\", ele);\n        ele = $('<img src=\"img/test.png\" class=\"img move\">').appendTo('.drop_area');    // 要素の追加\n        update(ele);    // 状態の更新\n    });\n    // 選択要素の削除ボタン\n    $(\"#deleteSelectedElement\").click(function () {\n        $('.selected').remove();\n        selected_elements = [];\n    });\n    // 選択要素の回転ボタン\n    $(\"#rotateSelectedElement\").click(function () {\n        // 選択中の全ての要素に対して45度の回転を適用\n        selected_elements.forEach(function( target_element ) {\n            var mat = target_element.css(\"transform\");  // matrixを取得\n            var vec = matrix2vec(mat);                  // matrixを行列に変換\n            vec = rotate2D(vec, 45);                    // 行列を45度回転\n            mat = vec2matrix(vec);                      // 行列をmatrixに戻す\n            target_element.css('transform',mat);        // 回転\n\n        });\n    });\n}\n\n// 更新があったときに呼び出される\nfunction update(ele){\n    // 適当なidを割り振る\n    uuid = generateUuid();\n    ele.attr('id',uuid)\n    // .move要素を移動可能にする\n    ele.draggable({\n        containment: \".drop_area\" //ドラッグの範囲を制限\n    });\n    // 選択可能にする\n    ele.click(function(){\n        if( ele.hasClass('selected') ){\n            ele.removeClass('selected');    // 要素からselectedクラスを削除\n            selected_elements = selected_elements.filter(n => n !== ele);   // selected_elements配列から，eleのみを削除する\n        }\n        else{\n            ele.addClass('selected');       // 要素にselectedクラスを追加\n            selected_elements.push(ele);    // 配列に追加\n        }\n    });\n}\n\n\n\n\n/* UUID生成 */\n// Cf. https://qiita.com/psn/items/d7ac5bdb5b5633bae165\nfunction generateUuid() {\n    // https://github.com/GoogleChrome/chrome-platform-analytics/blob/master/src/internal/identifier.js\n    // const FORMAT: string = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\";\n    let chars = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".split(\"\");\n    for (let i = 0, len = chars.length; i < len; i++) {\n        switch (chars[i]) {\n            case \"x\":\n                chars[i] = Math.floor(Math.random() * 16).toString(16);\n                break;\n            case \"y\":\n                chars[i] = (Math.floor(Math.random() * 4) + 8).toString(16);\n                break;\n        }\n    }\n    return chars.join(\"\");\n}\n\n\n\n/*二次元回転*/\n// 度数をradに変換\n// https://lab.syncer.jp/Web/JavaScript/Snippet/51/\nfunction deg2rad(degree){\n    return degree * ( Math.PI / 180 ) ;\n}\n\n// CSS matrixを配列に変換する\n// https://qiita.com/shogito/items/a5be366464d8cca5bafb\nfunction matrix2vec(matrix){\n    var re = /matrix\\((.*)\\)/;\n    var vals = matrix.match(re)[1].replace(/ /g, \"\").split(\",\");\n    vec = vals.map(Number)\n    return vec;\n}\nfunction vec2matrix(vec){\n    var vals = [];\n    // 有効桁数を揃える\n    vals[0] = vec[0].toFixed(20);\n    vals[1] = vec[1].toFixed(20);\n    vals[2] = vec[2].toFixed(20);\n    vals[3] = vec[3].toFixed(20);\n    vals[4] = vec[4].toFixed(20);\n    vals[5] = vec[5].toFixed(20);\n    // 文字列化\n    var matrix = \n        \"matrix(\"+\n        vals[0]+\",\"+\n        vals[1]+\",\"+\n        vals[2]+\",\"+\n        vals[3]+\",\"+\n        vals[4]+\",\"+\n        vals[5]+\")\";\n    return matrix;\n}\n\n// CSS matrixの二次元回転\n// https://w3e.kanazawa-it.ac.jp/math/category/gyouretu/senkeidaisu/henkan-tex.cgi?target=/math/category/gyouretu/senkeidaisu/rotation_matrix_2d.html\n// https://ginpen.com/2018/11/13/understanding-transform-matrix/\nfunction rotate2D(vec,degree){\n    var ret = new Array(6);\n    // xベクトルに二次元回転行列をかける\n    ret[0] = vec[0]*Math.cos(deg2rad(degree)) - vec[1]*Math.sin(deg2rad(degree));\n    ret[1] = vec[0]*Math.sin(deg2rad(degree)) + vec[1]*Math.cos(deg2rad(degree));\n    // yベクトルに二次元回転行列をかける\n    ret[2] = vec[2]*Math.cos(deg2rad(degree)) - vec[3]*Math.sin(deg2rad(degree));\n    ret[3] = vec[2]*Math.sin(deg2rad(degree)) + vec[3]*Math.cos(deg2rad(degree));\n    // 起点の指定\n    ret[4] = vec[4];\n    ret[5] = vec[5];\n    return ret;\n}\n"]},"metadata":{},"sourceType":"module"}